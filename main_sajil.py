import sajil_part_one
import sajil_part_two
import keyboards 
import utils 
import os # ุงููพูุฑุช ุถุฑูุฑ ุจุฑุง ุฏุณุชุฑุณ ุจู BOT_TOKEN (ูุฑุถ ู ุดูุฏ ุฏุฑ utils.py ุงุณุชูุงุฏู ู ุดูุฏ)

# ==============================================================================
# ุชุงุจุน ุงุตู ฺฉู ุงุฒ bot_app.py ูุฑุงุฎูุงู ูโุดูุฏ
# ==============================================================================
# ======================================================================
# ุงู ฺฉ ูุงู Placeholder ุงุณุช. ูุทูุง ุขู ุฑุง ุจุง ููุทู ุณุฌู ูุงูุน ุฌุงฺฏุฒู ฺฉูุฏ.
# ======================================================================

async def run_sajil_workflow(chat_id: int, incoming_text: str):
    """
    ุฌุฑุงู ฺฉุงุฑ ุณุฌู: ุฏุฑุงูุช ุงุนุฏุงุฏ/ฺฉููุงุช ฺฉูุฏ ู ุชููุฏ ููุงุฏ ูพุดููุงุฏ.
    """
    
    # ๐ฅ [ุงุตูุงุญ ุญุงุช]: Escape ฺฉุฑุฏู ูุชู ูุฑูุฏ ฺฉุงุฑุจุฑ ุจุฑุง ูุฑุงุฑฺฏุฑ ุงูู ุฏุฑ Code Block Inline
    # ุชููุง ุจฺฉโุชฺฉ ู ุจฺฉโุงุณูุด ุฏุฑ ุงูุฌุง Escape ูโุดููุฏ.
    escaped_user_input = utils.escape_code_block(incoming_text)
    
    # ุณุงุฎุชุงุฑ ูพุงู ุฎุฑูุฌ: 
    # ูุชู ุนุงุฏ ู ูุงุฑฺฉโุขูพ (ูุงููุฏ ** ู *) ุจุง utils.escape_markdown_v2 Escape ูโุดููุฏ.
    # ูุชู ุฏุงุฎู ุจฺฉโุชฺฉโูุง (`escaped_user_input`) ููุท ุจุง utils.escape_code_block Escape ุดุฏู ุงุณุช.
    output_parts = [
        utils.escape_markdown_v2("โ **ุงุทูุงุนุงุช ุณุฌู ุฏุฑุงูุช ุดุฏ!**\n\n"),
        utils.escape_markdown_v2("ุดูุง ุฏุงุฏูโูุง ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉุฑุฏุฏ: "),
        f"`{escaped_user_input}`", # โ๏ธ ุงู ูุณูุช ูุณุชููุง ุจุฏูู Escape ุนููู ูุฑุงุฑ ูโฺฏุฑุฏ
        utils.escape_markdown_v2("\n"),
        utils.escape_markdown_v2("ุชุญูู ููุงุฏุดูุงุณุงูู ู ุชููุฏ ุณุฌู (ููุงุฏ) ุจุฑ ุงุณุงุณ ุงุตูู ฺฏูุงุชุฑุง ู ุนุฏุฏุดูุงุณ ุงูุฌุงู ูโุดูุฏ.\n\n"),
        utils.escape_markdown_v2("**ููุงุฏ ูพุดููุงุฏ:** (ูุงุฒ ุจู ูพุงุฏูโุณุงุฒ ููุทู ุจุตุฑ ุง ุชููุฏ ฺฏุฑุงูฺฉ)\n"),
        utils.escape_markdown_v2("*ุงู ุจุฎุด ุจุฑุง ุชููุฏ ฺฏุฑุงูฺฉ ู ุชุญูู ุนููโุชุฑ ุจู ูุงฺููโูุง sajil_part_one ู sajil_part_two ุงุฑุณุงู ุดุฏ.*")
    ]
    
    output = "".join(output_parts)
    
    # ๐ก ุงุทููุงู ุงุฒ ุงุฑุณุงู ุจุง parse_mode ุตุญุญ (MarkdownV2)
    await utils.send_message(os.environ.get("BOT_TOKEN"), chat_id, output, keyboards.services_menu_keyboard())


# ูุงฺููโูุง sajil_part_one ู sajil_part_two ุจุงุฏ ุฏุฑ ูพุฑูฺู ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏ.
